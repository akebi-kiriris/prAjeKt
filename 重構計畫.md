# LearnLink é‡æ§‹è¨ˆç•«

> æœ€å¾Œæ›´æ–°ï¼š2026/02/27  
> é–‹ç™¼ç­–ç•¥ï¼š**çµæ§‹é‡æ§‹å„ªå…ˆ â†’ åŠŸèƒ½é–‹ç™¼ â†’ TypeScript é·ç§»**

---

## ğŸ“‹ ç›®éŒ„

1. [ç¾ç‹€åˆ†æ](#ç¾ç‹€åˆ†æ)
2. [ç›®æ¨™çµæ§‹](#ç›®æ¨™çµæ§‹)
3. [Phase 0 - çµæ§‹é‡æ§‹ï¼ˆMVP å‰ç½®ï¼‰](#phase-0---çµæ§‹é‡æ§‹mvp-å‰ç½®)
4. [Phase 1 - MVP æ ¸å¿ƒåŠŸèƒ½](#phase-1---mvp-æ ¸å¿ƒåŠŸèƒ½)
5. [Phase 2 - åŠŸèƒ½å®Œå–„](#phase-2---åŠŸèƒ½å®Œå–„)
6. [Phase 3 - TypeScript é·ç§»](#phase-3---typescript-é·ç§»)
7. [Phase 4 - é€²éšåŠŸèƒ½](#phase-4---é€²éšåŠŸèƒ½)
8. [åˆ‡ç‰‡å¼é–‹ç™¼æµç¨‹](#åˆ‡ç‰‡å¼é–‹ç™¼æµç¨‹)
9. [æŠ€è¡“æ£§](#æŠ€è¡“æ£§)

---

## ç¾ç‹€åˆ†æ

### ç•¶å‰å‰ç«¯çµæ§‹

```
frontend/src/
â”œâ”€â”€ App.vue              (60 è¡Œ â€” ä½ˆå±€)
â”œâ”€â”€ main.js              (14 è¡Œ â€” å…¥å£)
â”œâ”€â”€ style.css
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ auth.js          â† å”¯ä¸€çš„ store
â”œâ”€â”€ services/
â”‚   â””â”€â”€ api.js           â† å”¯ä¸€çš„ serviceï¼ˆåƒ… axios é…ç½® + æ””æˆªå™¨ï¼‰
â”œâ”€â”€ router/
â”‚   â””â”€â”€ index.js
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Header.vue       (42 è¡Œ)
â”‚   â””â”€â”€ Sidebar.vue      (54 è¡Œ)
â””â”€â”€ views/
    â”œâ”€â”€ HomeView.vue      (69 è¡Œ)
    â”œâ”€â”€ LoginView.vue     (115 è¡Œ)
    â”œâ”€â”€ RegisterView.vue  (207 è¡Œ)
    â”œâ”€â”€ TasksView.vue     (272 è¡Œ)
    â”œâ”€â”€ TodosView.vue     (301 è¡Œ)
    â”œâ”€â”€ ProfileView.vue   (309 è¡Œ)
    â”œâ”€â”€ GroupsView.vue    (320 è¡Œ)
    â””â”€â”€ TimelinesView.vue (2585 è¡Œ) â† å·¨å‹æª”æ¡ˆï¼
```

### å­˜åœ¨çš„å•é¡Œ

| å•é¡Œ | åš´é‡åº¦ | èªªæ˜ |
|------|--------|------|
| **God Component** | ğŸ”´ æ¥µåš´é‡ | `TimelinesView.vue` 2585 è¡Œï¼ŒåŒ…å«å°ˆæ¡ˆç®¡ç†ã€ä»»å‹™ç®¡ç†ã€çœ‹æ¿ã€æ—¥æ›†ã€AI ç”Ÿæˆã€ç•™è¨€ã€æª”æ¡ˆã€æˆå“¡åˆ†äº« |
| **ç„¡ Service å±¤** | ğŸ”´ åš´é‡ | æ¯å€‹ View ç›´æ¥ `import api` ç„¶å¾Œè‡ªå·±çµ„è£ API è·¯å¾‘ï¼Œç„¡å°è£ |
| **åªæœ‰ 1 å€‹ Store** | ğŸ”´ åš´é‡ | åªæœ‰ `auth.js`ï¼Œå…¶ä»–æ‰€æœ‰ç‹€æ…‹éƒ½æ˜¯ view-local çš„ `ref()`ï¼Œç„¡æ³•è·¨å…ƒä»¶å…±äº« |
| **é›¶å…ƒä»¶æ‹†åˆ†** | ğŸŸ¡ ä¸­ç­‰ | `components/` åªæœ‰ Header å’Œ Sidebarï¼Œå¤§é‡å¯é‡ç”¨ UI ç›´æ¥å¯«åœ¨ View è£¡ |
| **é‡è¤‡çš„å·¥å…·å‡½å¼** | ğŸŸ¡ ä¸­ç­‰ | `formatDate()` åœ¨ 4 å€‹ View å„å¯«äº†ä¸€æ¬¡ |
| **ä½¿ç”¨åŸç”Ÿ alert/confirm** | ğŸŸ¡ ä¸­ç­‰ | å…¨å°ˆæ¡ˆç”¨ `alert()`ã€`confirm()`ï¼Œæ²’æœ‰ toast ç³»çµ± |
| **ç„¡ Composables** | ğŸŸ¡ ä¸­ç­‰ | è¡¨å–®è™•ç†ã€æ—¥æœŸæ ¼å¼åŒ–ç­‰å¯æå–é‚è¼¯éƒ½å¯«æ­»åœ¨ View ä¸­ |

---

## ç›®æ¨™çµæ§‹

### å‰ç«¯ï¼ˆé‡æ§‹å¾Œï¼‰

```
frontend/src/
â”œâ”€â”€ App.vue
â”œâ”€â”€ main.js
â”œâ”€â”€ style.css
â”‚
â”œâ”€â”€ components/               # å…ƒä»¶ï¼ˆæŒ‰é ˜åŸŸåˆ†è³‡æ–™å¤¾ï¼‰
â”‚   â”œâ”€â”€ common/               # å…±ç”¨ UI å…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ BaseModal.vue         # é€šç”¨ Modal
â”‚   â”‚   â”œâ”€â”€ BaseCard.vue          # é€šç”¨å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ ToastNotification.vue # Toast é€šçŸ¥ï¼ˆå–ä»£ alertï¼‰
â”‚   â”‚   â”œâ”€â”€ ConfirmDialog.vue     # ç¢ºèªå°è©±æ¡†ï¼ˆå–ä»£ confirmï¼‰
â”‚   â”‚   â””â”€â”€ LoadingSpinner.vue    # Loading ç‹€æ…‹
â”‚   â”œâ”€â”€ timelines/            # å°ˆæ¡ˆ/æ™‚ç¨‹ç›¸é—œå…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ TimelineCard.vue
â”‚   â”‚   â”œâ”€â”€ TimelineDetail.vue
â”‚   â”‚   â”œâ”€â”€ TimelineForm.vue
â”‚   â”‚   â”œâ”€â”€ TaskDetailModal.vue
â”‚   â”‚   â”œâ”€â”€ AddTaskModal.vue
â”‚   â”‚   â”œâ”€â”€ KanbanBoard.vue
â”‚   â”‚   â”œâ”€â”€ KanbanColumn.vue
â”‚   â”‚   â”œâ”€â”€ KanbanTaskCard.vue
â”‚   â”‚   â”œâ”€â”€ CalendarView.vue
â”‚   â”‚   â”œâ”€â”€ AiGenerateModal.vue
â”‚   â”‚   â”œâ”€â”€ SharePanel.vue
â”‚   â”‚   â””â”€â”€ StatsOverview.vue
â”‚   â”œâ”€â”€ tasks/                # ä»»å‹™ç›¸é—œå…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ TaskCard.vue
â”‚   â”‚   â””â”€â”€ TaskForm.vue
â”‚   â”œâ”€â”€ todos/                # å¾…è¾¦ç›¸é—œå…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ TodoItem.vue
â”‚   â”‚   â””â”€â”€ TodoForm.vue
â”‚   â”œâ”€â”€ groups/               # ç¾¤çµ„ç›¸é—œå…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ GroupCard.vue
â”‚   â”‚   â””â”€â”€ ChatPanel.vue
â”‚   â”œâ”€â”€ Header.vue
â”‚   â””â”€â”€ Sidebar.vue
â”‚
â”œâ”€â”€ composables/              # å¯é‡ç”¨é‚è¼¯ï¼ˆçµ„åˆå¼å‡½å¼ï¼‰
â”‚   â”œâ”€â”€ useFormatDate.js          # formatDate, formatTime, formatDeadline
â”‚   â”œâ”€â”€ useToast.js               # toast é€šçŸ¥
â”‚   â”œâ”€â”€ useConfirm.js             # ç¢ºèªå°è©±æ¡†
â”‚   â”œâ”€â”€ useTaskFilters.js         # ä»»å‹™æœå°‹/ç¯©é¸/æ’åº
â”‚   â”œâ”€â”€ useTimelineStatus.js      # getDaysRemaining, getTimelineStatus
â”‚   â””â”€â”€ useForm.js                # é€šç”¨è¡¨å–® reset/submit
â”‚
â”œâ”€â”€ services/                 # API è«‹æ±‚å±¤ï¼ˆæ¯å€‹é ˜åŸŸä¸€å€‹ serviceï¼‰
â”‚   â”œâ”€â”€ api.js                    # axios å¯¦ä¾‹ + æ””æˆªå™¨ï¼ˆå·²å®Œæˆï¼‰
â”‚   â”œâ”€â”€ authService.js            # /auth ç›¸é—œ API
â”‚   â”œâ”€â”€ taskService.js            # /tasks ç›¸é—œ API
â”‚   â”œâ”€â”€ timelineService.js        # /timelines ç›¸é—œ API
â”‚   â”œâ”€â”€ todoService.js            # /todos ç›¸é—œ API
â”‚   â”œâ”€â”€ groupService.js           # /groups ç›¸é—œ API
â”‚   â””â”€â”€ profileService.js         # /profile ç›¸é—œ API
â”‚
â”œâ”€â”€ stores/                   # Pinia ç‹€æ…‹ç®¡ç†ï¼ˆæ¯å€‹é ˜åŸŸä¸€å€‹ storeï¼‰
â”‚   â”œâ”€â”€ auth.js                   # èªè­‰ï¼ˆå·²å®Œæˆï¼‰
â”‚   â”œâ”€â”€ tasks.js                  # ä»»å‹™ CRUDã€ç‹€æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ timelines.js              # å°ˆæ¡ˆ CRUDã€æˆå“¡ç®¡ç†
â”‚   â”œâ”€â”€ todos.js                  # å¾…è¾¦ CRUD
â”‚   â”œâ”€â”€ groups.js                 # ç¾¤çµ„ CRUDã€è¨Šæ¯
â”‚   â”œâ”€â”€ profile.js                # å€‹äººè³‡æ–™
â”‚   â””â”€â”€ ui.js                     # UI ç‹€æ…‹ï¼ˆtoastã€sidebarã€modalï¼‰
â”‚
â”œâ”€â”€ utils/                    # ç´”å·¥å…·å‡½å¼
â”‚   â”œâ”€â”€ formatters.js             # æ ¼å¼åŒ–ï¼ˆæ—¥æœŸã€æ•¸å­—ç­‰ï¼‰
â”‚   â””â”€â”€ validators.js             # é©—è­‰è¦å‰‡
â”‚
â”œâ”€â”€ router/
â”‚   â””â”€â”€ index.js
â”‚
â””â”€â”€ views/                    # ç˜¦ Viewï¼ˆåªåšä½ˆå±€å’Œçµ„è£å…ƒä»¶ï¼‰
    â”œâ”€â”€ HomeView.vue
    â”œâ”€â”€ LoginView.vue
    â”œâ”€â”€ RegisterView.vue
    â”œâ”€â”€ TasksView.vue
    â”œâ”€â”€ TimelinesView.vue
    â”œâ”€â”€ TodosView.vue
    â”œâ”€â”€ GroupsView.vue
    â””â”€â”€ ProfileView.vue
```

### å¾Œç«¯ï¼ˆå¾®èª¿ï¼‰

```
backend/
â”œâ”€â”€ app.py
â”œâ”€â”€ blueprints/            # è·¯ç”±å±¤ï¼ˆå·²å®Œæˆï¼‰
â”œâ”€â”€ models/                # è³‡æ–™æ¨¡å‹ï¼ˆå·²å®Œæˆï¼‰
â”œâ”€â”€ services/              # ã€æ–°å¢ã€‘å•†æ¥­é‚è¼¯å±¤
â”‚   â”œâ”€â”€ timeline_service.py
â”‚   â”œâ”€â”€ task_service.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ migrations/
â””â”€â”€ uploads/
```

---

## Phase 0 - çµæ§‹é‡æ§‹ï¼ˆæ¥µç°¡å¯åŸ·è¡Œç‰ˆï¼‰

> **ç›®æ¨™ï¼šå»ºç«‹å¯ç¶­è­·ä¸‰å±¤æ¶æ§‹ + è®“ Timelines ä¸å†ææ€–**  
> **åŸå‰‡ï¼šç´”æ¬ç§»ï¼Œä¸å„ªåŒ–ï¼Œä¸æ–°å¢åŠŸèƒ½ã€‚åšå®Œä¸€æ­¥æ¸¬è©¦ä¸€æ­¥å†å¾€ä¸‹ã€‚**  
> **âš ï¸ è¨ˆç•«è¨è«–åˆ°æ­¤ç‚ºæ­¢ï¼Œé–‹å§‹å¯« codeã€‚**

---

### ğŸ”§ Step 0-1ï¼šå»ºç«‹ Service å±¤ âœ… å®Œæˆï¼ˆ1 å¤©ï¼ŒåŸä¼° 3 å¤©ï¼‰

> æ‰€æœ‰ View ç›´æ¥æ‰“ API çš„ç¨‹å¼ç¢¼ï¼Œå…¨éƒ¨æ¬åˆ° service æª”æ¡ˆã€‚  
> **è¦å‰‡ï¼šä¸æ”¹ä»»ä½•é‚è¼¯ï¼Œç´”æ¬ç§»ã€‚**

- [x] `services/todoService.js` â€” å°è£ `/todos` æ‰€æœ‰ API
- [x] `services/taskService.js` â€” å°è£ `/tasks` æ‰€æœ‰ APIï¼ˆå« subtaskã€updateStatusï¼‰
- [x] `services/groupService.js` â€” å°è£ `/groups` æ‰€æœ‰ API
- [x] `services/profileService.js` â€” å°è£ `/profile` æ‰€æœ‰ API
- [x] `services/timelineService.js` â€” å°è£ `/timelines` æ‰€æœ‰ API
- [x] æ›´æ–°å„ View æ”¹ç”¨ serviceï¼ˆView é‚è¼¯ä¸å‹•ï¼Œåªæ›å‘¼å«æ–¹å¼ï¼‰
- [x] æ¸¬è©¦æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

**Service ç¯„ä¾‹ï¼š**
```javascript
// services/todoService.js
import api from './api';

export const todoService = {
  getAll:         ()         => api.get('/todos'),
  create:         (data)     => api.post('/todos', data),
  update:         (id, data) => api.put(`/todos/${id}`, data),
  delete:         (id)       => api.delete(`/todos/${id}`),
  toggleComplete: (id)       => api.patch(`/todos/${id}/toggle`),
};
```

---

### ğŸ”§ Step 0-2ï¼šå»ºç«‹ Store å±¤ âœ… å®Œæˆï¼ˆ1 å¤©ï¼ŒåŸä¼° 3ï½5 å¤©ï¼‰

> å…ˆåš todos å’Œ tasksï¼Œç¢ºèª View â†’ Store â†’ Service æµç¨‹è·‘é€šå†å¾€ä¸‹ã€‚  
> **groupsã€profileã€timelines store ä¹‹å¾Œå†è£œã€‚**

- [x] `stores/todos.js` â€” æ¬ç§» TodosView çš„ç‹€æ…‹èˆ‡é‚è¼¯
- [x] TodosView æ”¹ç”¨ storeï¼Œæ¸¬è©¦åŠŸèƒ½æ­£å¸¸
- [x] `stores/tasks.js` â€” æ¬ç§» TasksView çš„ç‹€æ…‹èˆ‡é‚è¼¯
- [x] TasksView æ”¹ç”¨ storeï¼Œæ¸¬è©¦åŠŸèƒ½æ­£å¸¸
- [ ] ï¼ˆç©©å®šå¾Œï¼‰`stores/groups.js`
- [ ] ï¼ˆç©©å®šå¾Œï¼‰`stores/profile.js`

**Store ç¯„ä¾‹ï¼š**
```javascript
// stores/todos.js
import { defineStore } from 'pinia';
import { ref, computed } from 'vue';
import { todoService } from '../services/todoService';

export const useTodoStore = defineStore('todos', () => {
  const todos = ref([]);
  const loading = ref(false);

  const completedTodos = computed(() => todos.value.filter(t => t.completed));
  const pendingTodos = computed(() => todos.value.filter(t => !t.completed));

  async function fetchTodos() {
    loading.value = true;
    try {
      const res = await todoService.getAll();
      todos.value = res.data.todos;
    } finally {
      loading.value = false;
    }
  }

  async function addTodo(data) {
    const res = await todoService.create(data);
    todos.value.unshift(res.data.todo);
  }

  return { todos, loading, completedTodos, pendingTodos, fetchTodos, addTodo };
});
```

---

### âœ… Step 0-3ï¼šTimelinesView ç¬¬ä¸€å±¤æ‹†åˆ†ï¼ˆ2026/02/25 å®Œæˆï¼‰

> å¯¦éš›çµæœï¼š2569 è¡Œ â†’ **301 è¡Œ**ï¼ˆé™å¹… 88%ï¼‰ï¼é è¶…ç›®æ¨™ã€‚  
> æŒ‰åŠŸèƒ½å€åŸŸæ‹†åˆ†ï¼Œå››ç¨®è¦–åœ–æ¨¡å¼åˆä½µåœ¨ ViewModes çµ„ä»¶ä¸­ï¼Œ  
> å„å­å…ƒä»¶å‡å¯è‡ªè¡Œå‘¼å« serviceï¼Œé€é emit é€šçŸ¥çˆ¶å±¤åˆ·æ–°ã€‚

- [x] å»ºç«‹ `components/timelines/` è³‡æ–™å¤¾
- [x] æŠ½å– `TimelineHeader.vue` â€” Header + Stats + View Toggle (125 è¡Œ)
- [x] æŠ½å– `TimelineViewModes.vue` â€” å››ç¨®è¦–åœ–æ¨¡å¼ + çœ‹æ¿ä»»å‹™ Modal (741 è¡Œ)
- [x] æŠ½å– `TimelineDetailDialog.vue` â€” å°ˆæ¡ˆè©³æƒ… + ä»»å‹™ç›¸é—œæ‰€æœ‰ Modal (405 è¡Œ)
- [x] TimelinesView.vue é™åˆ° **301 è¡Œ**ï¼ˆå« CSSï¼‰
- [x] ç·¨è­¯é€šéï¼Œ136 æ¨¡çµ„ç„¡éŒ¯èª¤
- [x] **åœæ­¢ï¼Œé€²å…¥ Phase 1**

**å„å…ƒä»¶è·è²¬ï¼š**
- `TimelineViewModes.vue`ï¼šæœ¬åœ°ç®¡ç†çœ‹æ¿ç¯©é¸ç‹€æ…‹ã€æœˆæ›† refã€çœ‹æ¿ä»»å‹™è©³æƒ… Modalï¼›ç›´æ¥å‘¼å« `taskService` è™•ç†æ‹–æ›³ã€å­ä»»å‹™æ“ä½œï¼›emit `refresh-all` é€šçŸ¥çˆ¶å±¤
- `TimelineDetailDialog.vue`ï¼šæœ¬åœ°ç®¡ç†æ‰€æœ‰ Modal çš„é–‹é—œç‹€æ…‹ï¼›ç›´æ¥å‘¼å« `taskService`/`timelineService` è™•ç†ä»»å‹™æ–°å¢ã€å‚™è¨»ã€ç•™è¨€ã€AI ç”Ÿæˆã€æˆå“¡é‚€è«‹ï¼›emit `toggle-task`/`delete-task`/`refresh-all`
- `TimelinesView.vue`ï¼šåƒ…ä¿ç•™ timelines/allTasks/selectedTimeline ç­‰æ ¸å¿ƒç‹€æ…‹ã€å°ˆæ¡ˆ CRUDã€å­å…ƒä»¶ emit çš„é ‚å±¤è™•ç†

> â¸ï¸ è¦–åœ–æ¨¡å¼ç´°æ‹†ï¼ˆCardViewã€KanbanViewã€CalendarViewï¼‰ç•™åˆ° Phase 1ã€‚

---

### âŒ å»¶å¾Œäº‹é …ï¼ˆä¸åœ¨ Phase 0 å…§ï¼‰

ä»¥ä¸‹ç­‰ Phase 0 å®Œæˆä¸”ç©©å®šå¾Œå†åšï¼š

- Toast / ConfirmDialog / BaseModal ç­‰ UI åŸºå»º
- utils/formatters.js æ•´ç†
- composables æŠ½å–
- timelines store
- å…ƒä»¶ç´°æ‹†ï¼ˆKanbanã€Calendar ç­‰ï¼‰

---

## Phase 1 - MVP æ ¸å¿ƒåŠŸèƒ½

> **ç›®æ¨™ï¼šçµæ§‹é‡æ§‹å®Œæˆå¾Œï¼Œé–‹å§‹å¯¦ä½œæ ¸å¿ƒåŠŸèƒ½**  
> **å‰æï¼šPhase 0 å®Œæˆ** âœ…  
> **æœ€å¾Œæ›´æ–°ï¼š2026/02/26**

### 1. å¤šäººå”ä½œèˆ‡æ¬Šé™ç³»çµ± âœ… å®Œæˆï¼ˆ2026/02/27ï¼‰

#### å¾Œç«¯ âœ… å®Œæˆï¼ˆ2026/02/26ï¼‰

- [x] `timeline_users.role` æ¬„ä½å·²å­˜åœ¨ï¼ˆ0=è² è²¬äººã€1=å”ä½œè€…ï¼Œç„¡ Viewer â€” MVP ä¸éœ€è¦ï¼‰
- [x] `get_user_timeline_role(user_id, timeline_id)` helperï¼ˆORMï¼‰
- [x] `require_timeline_role('owner' | 'member')` decorator factory
- [x] `create_timeline` å»ºç«‹å¾Œè‡ªå‹•æ’å…¥ `timeline_users`ï¼ˆrole=0ï¼‰
- [x] `get_timelines` æ”¹ JOIN `timeline_users`ï¼Œå›å‚³æ¯æ¢ timeline çš„ `role`
- [x] æ‰€æœ‰ timeline è·¯ç”±å¥—ä¸Š decoratorï¼ˆowner/member åˆ†ç´šï¼‰
- [x] æ–°å¢ `DELETE /<id>/members/<member_user_id>` â€” è² è²¬äººè¸¢äººï¼Œä¸èƒ½è‡ªè¸¢
- [x] å…¨é¢ ORM åŒ–ï¼ˆç§»é™¤æ‰€æœ‰ raw SQLï¼‰
- [x] æ¸…é™¤ç„¡ç”¨ `user_id = int(get_jwt_identity())` å®£å‘Šï¼ˆå…±ç§»é™¤ 6 è™•ï¼‰

**æ¬Šé™å°ç…§è¡¨ï¼š**

| æ“ä½œ | Owner (0) | Collaborator (1) |
|------|:---------:|:----------------:|
| çœ‹ä»»å‹™ / ç•™è¨€ / ä¸Šå‚³æª”æ¡ˆ | âœ… | âœ… |
| æ–°å¢ä»»å‹™ / ç·¨è¼¯å‚™è¨» | âœ… | âœ… |
| ç·¨è¼¯å°ˆæ¡ˆè³‡è¨Šï¼ˆåç¨±/æ—¥æœŸï¼‰| âœ… | âŒ 403 |
| åˆªé™¤å°ˆæ¡ˆ | âœ… | âŒ 403 |
| æ–°å¢ / ç§»é™¤æˆå“¡ | âœ… | âŒ 403 |

#### å‰ç«¯ ğŸ”„ éƒ¨åˆ†å®Œæˆï¼ˆ2026/02/26ï¼‰

- [x] `timelineService.js` æ–°å¢ `removeMember`
- [x] `TimelineViewModes.vue` â€” âœï¸ ğŸ—‘ï¸ æŒ‰éˆ•åŠ  `v-if="timeline.role === 0"`ï¼ˆList + Card å„ 2 è™•ï¼‰
- [x] `TimelineDetailDialog.vue` â€” ã€Œæˆå“¡ç®¡ç†ã€æŒ‰éˆ•åŠ  `v-if="selectedTimeline?.role === 0"`
- [x] **èˆŠè³‡æ–™è£œå¡«** â€” è·‘ `backfill_timeline_users.py`ï¼Œ5 ç­†è£œå¡«å®Œæˆ
- [x] å‰ç«¯æˆå“¡ç®¡ç† UI é¡¯ç¤ºç¾æœ‰æˆå“¡åˆ—è¡¨ + è¸¢äººæŒ‰éˆ•ï¼ˆå‘¼å« `removeMember`ï¼‰

#### Tasks å¤šäººå”ä½œ âœ… å®Œæˆï¼ˆ2026/02/27ï¼‰

> `task_user` è¡¨çµæ§‹èˆ‡æ¬„ä½é½Šå…¨ï¼ˆrole=0 è² è²¬äºº / 1 å”ä½œè€…ï¼‰ã€‚  
> å¾Œç«¯å·²çµ±ä¸€æ”¹ç”¨ `task_user` åšæ‰€æœ‰æ¬Šé™åˆ¤æ–·ï¼ŒèˆŠçš„ `task.user_id` é‚è¼¯å·²æ¸…é™¤ã€‚

- [x] æ–°å¢ `get_user_task_role()` helperï¼ˆå…ˆæŸ¥ `task_user`ï¼Œè‹¥ç„¡ä¸”ä»»å‹™å±¬æ–¼ timeline å‰‡ç¹¼æ‰¿ `timeline_user.role`ï¼‰
- [x] æ–°å¢ `require_task_role('member' | 'owner')` decorator factory
- [x] 14 å€‹è·¯ç”±å…¨å¥—ä¸Š decoratorï¼ˆè¦‹ä¸‹è¡¨ï¼‰
- [x] `create_task` å»ºç«‹å¾Œè‡ªå‹• insert `task_user(role=0)` çµ¦å»ºç«‹è€…
- [x] `assistant` æ¬„ä½å·²å»¢æ£„ â€” model ç§»é™¤æ¬„ä½ã€migration åŸ·è¡Œå®Œæˆã€å‰ç«¯ UI/store åŒæ­¥æ¸…é™¤

**è·¯ç”±æ¬Šé™å°ç…§è¡¨ï¼š**

| è·¯ç”± | æ¬Šé™ | æ”¹å‹•èªªæ˜ |
|------|------|----------|
| `PUT /<id>` update_task | member | ç§»é™¤èˆŠ `task.user_id` æ¯”å° |
| `DELETE /<id>` delete_task | owner | ç§»é™¤èˆŠ filter_by user_id æŸ¥è©¢ |
| `PATCH /<id>/toggle` | member | ç§»é™¤èˆŠ is_member æ¯”å° |
| `GET /<id>/members` | member | åŸæœ¬å®Œå…¨ç„¡ä¿è­· |
| `POST /<id>/members` | owner | ç§»é™¤èˆŠ `task.user_id` æ¯”å° |
| `DELETE /<id>/members/<id>` | owner | ç§»é™¤èˆŠ `task.user_id` æ¯”å° |
| `GET /<id>/comments` | member | åŸæœ¬å®Œå…¨ç„¡ä¿è­· |
| `POST /<id>/comments` | member | ç§»é™¤å¤šé¤˜çš„ task æŸ¥è©¢ |
| `GET /<id>/subtasks` | member | åŸæœ¬å®Œå…¨ç„¡ä¿è­· |
| `POST /<id>/subtasks` | member | ç§»é™¤å¤šé¤˜çš„ task æŸ¥è©¢ |
| `PUT /<id>/subtasks/<id>` | member | åŸæœ¬å®Œå…¨ç„¡ä¿è­· |
| `DELETE /<id>/subtasks/<id>` | member | åŸæœ¬å®Œå…¨ç„¡ä¿è­· |
| `PATCH /<id>/subtasks/<id>/toggle` | member | åŸæœ¬å®Œå…¨ç„¡ä¿è­· |
| `PATCH /<id>/status` | member | ç§»é™¤èˆŠ is_member æ¯”å° |

---

### 2. ä»»å‹™ç•™è¨€èˆ‡æª”æ¡ˆä¸Šå‚³ ğŸ”´ é«˜å„ªå…ˆ â€” æœªé–‹å§‹

- [ ] ç•™è¨€è¼¸å…¥å€æ”¯æ´é™„åŠ æª”æ¡ˆï¼ˆåœ–ç‰‡ã€PDFã€æ–‡ä»¶ï¼‰
- [ ] ä»»å‹™è©³æƒ…ã€Œæª”æ¡ˆå€ã€é›†ä¸­é¡¯ç¤ºæ‰€æœ‰é™„ä»¶
- [ ] æª”æ¡ˆé è¦½ï¼ˆåœ–ç‰‡ inlineã€å…¶ä»–é–‹æ–°åˆ†é ï¼‰ã€ä¸‹è¼‰ã€åˆªé™¤

---

### 3. åƒåœ¾æ¡¶æ©Ÿåˆ¶ ğŸŸ¡ ä¸­å„ªå…ˆ â€” æœªé–‹å§‹

- [ ] å¾Œç«¯æ–°å¢æŸ¥è©¢ / é‚„åŸ / æ°¸ä¹…åˆªé™¤ API
- [ ] åƒåœ¾æ¡¶é é¢ï¼ˆSidebar æ–°å¢å…¥å£ï¼‰
- [ ] 30 å¤©è‡ªå‹•æ¸…ç†ï¼ˆå¯é¸ï¼‰

---

### 4. Token åˆ·æ–°æ©Ÿåˆ¶ âœ… å·²å®Œæˆ

- å¾Œç«¯ `/auth/refresh` endpoint âœ…
- å‰ç«¯ Response æ””æˆªå™¨è‡ªå‹•åˆ·æ–° âœ…
- é˜²æ­¢ç«¶æ…‹æ¢ä»¶ï¼ˆQueue æ©Ÿåˆ¶ï¼‰âœ…

---

## Phase 2 - åŠŸèƒ½å®Œå–„

### 5. é€šçŸ¥ç³»çµ± ğŸŸ¢ ä½å„ªå…ˆ
- å³æ™‚é€šçŸ¥ï¼ˆä»»å‹™æŒ‡æ´¾ã€æ–°ç•™è¨€ã€å³å°‡åˆ°æœŸï¼‰
- é€šçŸ¥ä¸­å¿ƒ UI
- WebSocket æˆ–è¼ªè©¢

### 6. æ•¸æ“šåˆ†æå„€è¡¨æ¿ ğŸŸ¢ ä½å„ªå…ˆ
- é€²åº¦çµ±è¨ˆï¼ˆå®Œæˆç‡ã€é€¾æœŸç‡ï¼‰
- æ•ˆç‡åˆ†æ
- åœ–è¡¨åº«ï¼ˆChart.js / EChartsï¼‰

### 7. è¡Œå‹•ç‰ˆå„ªåŒ– ğŸŸ¡ ä¸­å„ªå…ˆ
- æ‰‹æ©Ÿï¼šåº•éƒ¨å°èˆªåˆ—
- å¹³æ¿ï¼šæŠ½å±œå¼ Sidebar
- æ¡Œé¢ï¼šå·¦å´ Sidebarï¼ˆç¶­æŒï¼‰

---

## Phase 3 - TypeScript é·ç§»

> **å‰æï¼šJavaScript é‡æ§‹å®Œæˆä¸”ç©©å®šé‹è¡Œå¾Œ**
> **åŸå‰‡ï¼šæ¼¸é€²å¼é·ç§»ï¼Œä¸éœ€ä¸€æ¬¡å…¨æ”¹**

### é·ç§»é †åºï¼ˆç”±åº•å±¤åˆ°ä¸Šå±¤ï¼‰

1. **åŸºç¤å±¤**
   - [ ] `utils/formatters.js` â†’ `formatters.ts`
   - [ ] `utils/validators.js` â†’ `validators.ts`
   - [ ] å®šç¾©å…±ç”¨å‹åˆ¥ `types/index.ts`

2. **Service å±¤**
   - [ ] `services/api.js` â†’ `api.ts`
   - [ ] `services/todoService.js` â†’ `todoService.ts`
   - [ ] `services/taskService.js` â†’ `taskService.ts`
   - [ ] å…¶ä»– services...

3. **Store å±¤**
   - [ ] `stores/auth.js` â†’ `auth.ts`
   - [ ] `stores/todos.js` â†’ `todos.ts`
   - [ ] å…¶ä»– stores...

4. **Composables**
   - [ ] æ‰€æœ‰ composables é·ç§»ç‚º .ts

5. **å…ƒä»¶å±¤**
   - [ ] `<script setup>` â†’ `<script setup lang="ts">`
   - [ ] å®šç¾© Props/Emits å‹åˆ¥
   - [ ] é€ä¸€é·ç§» components å’Œ views

### TS å‹åˆ¥å®šç¾©ç¯„ä¾‹

```typescript
// types/index.ts
export interface User {
  id: number;
  name: string;
  username: string | null;
  email: string;
  phone: string | null;
}

export interface Todo {
  id: number;
  title: string;
  content: string | null;
  completed: boolean;
  user_id: number;
  created_at: string;
}

export interface Timeline {
  id: number;
  name: string;
  description: string | null;
  start_date: string;
  end_date: string;
  deleted: boolean;
  created_by: number;
}

export interface Task {
  id: number;
  title: string;
  description: string | null;
  status: 'todo' | 'in_progress' | 'done';
  priority: 'low' | 'medium' | 'high';
  timeline_id: number;
  deleted: boolean;
}
```

### Vite è¨­å®šèª¿æ•´

```javascript
// vite.config.js - ç„¡éœ€å¤§æ”¹ï¼ŒVite åŸç”Ÿæ”¯æ´ TS
// åªè¦å®‰è£ typescript å’Œèª¿æ•´ tsconfig.json å³å¯
```

---

## Phase 4 - é€²éšåŠŸèƒ½

> **ç­‰ Phase 1-3 å®Œæˆå¾Œå†è€ƒæ…®**

### 8. ç”˜ç‰¹åœ–è¦–è¦ºåŒ–
- æ•´åˆ Gantt åº«ï¼ˆdhtmlx-gantt / frappe-ganttï¼‰
- ä»»å‹™ä¾è³´é—œä¿‚
- æ‹–æ›³èª¿æ•´æ™‚é–“

### 9. å¾Œç«¯ Service Layer é‡æ§‹
- æŠ½é›¢ Blueprint ä¸­çš„å•†æ¥­é‚è¼¯
- æ–°å¢ `backend/services/` è³‡æ–™å¤¾
- æ¸›å°‘ Blueprint ç›´æ¥æ“ä½œè³‡æ–™åº«

### 10. è³‡æ–™åº«é·ç§»
- SQLite â†’ PostgreSQLï¼ˆç”Ÿç”¢ç’°å¢ƒï¼‰

### 11. å³æ™‚é€šè¨Š
- WebSocket (Flask-SocketIO)
- ç¾¤çµ„å³æ™‚èŠå¤©

---

## åˆ‡ç‰‡å¼é–‹ç™¼æµç¨‹

### æ¯å€‹åŠŸèƒ½çš„æ¨™æº–æµç¨‹

#### Step 1ï¼šè³‡æ–™è¡¨è¨­è¨ˆ
- [ ] åˆ†æåŠŸèƒ½éœ€æ±‚ï¼Œç¢ºå®šæ‰€éœ€è³‡æ–™è¡¨
- [ ] è¨­è¨ˆæ¬„ä½èˆ‡è³‡æ–™é¡å‹
- [ ] è¦åŠƒå¤–éµé—œè¯èˆ‡ç´¢å¼•

#### Step 2ï¼šè³‡æ–™åº«é·ç§»
- [ ] ä¿®æ”¹æˆ–æ–°å¢ Modelï¼ˆ`backend/models/`ï¼‰
- [ ] åŸ·è¡Œ `flask db migrate -m "æè¿°"`
- [ ] åŸ·è¡Œ `flask db upgrade`
- [ ] é©—è­‰è³‡æ–™è¡¨çµæ§‹æ­£ç¢º

#### Step 3ï¼šå¾Œç«¯ API é–‹ç™¼
- [ ] å»ºç«‹æˆ–ä¿®æ”¹ Blueprintï¼ˆ`backend/blueprints/`ï¼‰
- [ ] å¯¦ä½œ CRUD API
- [ ] åŠ å…¥é©—è­‰èˆ‡éŒ¯èª¤è™•ç†
- [ ] æ¸¬è©¦ APIï¼ˆPostman/curlï¼‰

#### Step 4ï¼šå‰ç«¯é–‹ç™¼ï¼ˆé‡æ§‹å¾Œçš„æ¨™æº–æµç¨‹ï¼‰
- [ ] å»ºç«‹ Serviceï¼ˆ`services/xxxService.js`ï¼‰â€” å°è£ API
- [ ] å»ºç«‹ Storeï¼ˆ`stores/xxx.js`ï¼‰â€” ç®¡ç†ç‹€æ…‹
- [ ] å»ºç«‹ Components â€” æ‹†åˆ† UI
- [ ] æ›´æ–° View â€” çµ„è£å…ƒä»¶ + ä½¿ç”¨ store
- [ ] å»ºç«‹/æ›´æ–° Composables â€” æå–å¯é‡ç”¨é‚è¼¯

#### Step 5ï¼šæ•´åˆæ¸¬è©¦
- [ ] å‰å¾Œç«¯è¯èª¿æ¸¬è©¦
- [ ] é‚Šç•Œæƒ…æ³æ¸¬è©¦
- [ ] ç¢ºèªä¸å½±éŸ¿å…¶ä»–åŠŸèƒ½

### åŸ·è¡ŒåŸå‰‡

1. ä¸€æ¬¡åªé‡æ§‹ä¸€å€‹æ¨¡çµ„
2. å®Œæˆ Service â†’ Store â†’ Component â†’ View çš„å®Œæ•´æµç¨‹
3. æ¸¬è©¦é€šéå¾Œå†é€²å…¥ä¸‹ä¸€å€‹
4. ä¿æŒå…¶ä»–åŠŸèƒ½æ­£å¸¸é‹ä½œ

---

## æŠ€è¡“æ£§

### ç•¶å‰ä½¿ç”¨

| å±¤ç´š | æŠ€è¡“ |
|------|------|
| å‰ç«¯æ¡†æ¶ | Vue 3 + Vite |
| ç‹€æ…‹ç®¡ç† | Pinia |
| è·¯ç”± | Vue Router |
| HTTP è«‹æ±‚ | Axios |
| æ¨£å¼ | Tailwind CSS |
| å¾Œç«¯ | Flask + SQLAlchemy + Flask-Migrate |
| èªè­‰ | JWTï¼ˆFlask-JWT-Extendedï¼‰|
| è³‡æ–™åº« | SQLiteï¼ˆé–‹ç™¼ï¼‰|

### æœªä¾†å¼•å…¥

| æŠ€è¡“ | æ™‚æ©Ÿ | ç”¨é€” |
|------|------|------|
| TypeScript | Phase 3 | å‹åˆ¥å®‰å…¨ |
| PostgreSQL | Phase 4 | ç”Ÿç”¢è³‡æ–™åº« |
| Redis | Phase 4 | å¿«å– |
| WebSocket | Phase 4 | å³æ™‚é€šè¨Š |
| Chart.js / ECharts | Phase 2 | æ•¸æ“šåœ–è¡¨ |

---

## ğŸš« ä¸ç´å…¥é …ç›®
- âŒ æ·±è‰²æ¨¡å¼ï¼ˆside project æš«ä¸è€ƒæ…®ï¼‰

---

## ğŸ“ å‚™è¨»

- æ–°éœ€æ±‚è«‹è£œå……æ–¼å°æ‡‰ Phase
- æ¯å€‹æ­¥é©Ÿå®Œæˆå¾Œæ¨™è¨˜ âœ…
- å®šæœŸæª¢è¦–å„ªå…ˆç´šèª¿æ•´
- Phase 0 é‡æ§‹æœŸé–“ï¼š**ä¸æ–°å¢åŠŸèƒ½ï¼Œåªæ¬ç§»å’Œæ‹†åˆ†ç¨‹å¼ç¢¼**
- Phase 3 TypeScript é·ç§»ï¼šç­‰ JS ç‰ˆç©©å®šä¸”å­¸å¥½ TS å¾Œå†é€²è¡Œ

---

## æ­·å²è¨˜éŒ„

### 2026/01/22 é€²åº¦
- å®Œæˆã€ŒAI ä»»å‹™ç”Ÿæˆã€åŠŸèƒ½ï¼Œæ•´åˆ Google Generative AI (Gemini 2.5 Flash Lite)
- å®Œæˆã€Œè»Ÿåˆªé™¤ã€(Soft Delete) æ©Ÿåˆ¶
- Alembic migration è¡çªè§£æ±º
- .gitignore æª¢æŸ¥å®Œæˆ

### 2026/02/19 ç™¼ç¾èˆ‡ä¿®æ­£
- ç™¼ç¾ç¼ºå°‘ Token åˆ·æ–°æ©Ÿåˆ¶
- ä¿®æ­£ `window.location.href` â†’ `router.push()`ï¼ˆSPA æ­£ç¢ºåšæ³•ï¼‰

### 2026/02/21 å®Œæˆ
- å¾Œç«¯æ–°å¢ `/auth/refresh` endpoint
- å‰ç«¯ Response æ””æˆªå™¨å¯¦ä½œå®Œæ•´çš„ token è‡ªå‹•åˆ·æ–°æ©Ÿåˆ¶ï¼ˆå« Queue é˜²ç«¶æ…‹ï¼‰
- æå– `BASE_URL` å¸¸æ•¸é¿å…é‡è¤‡å®šç¾©

### 2026/02/24~25 Phase 0 Step 0-1, 0-2 å®Œæˆ
- **Step 0-1 å®Œæˆ**ï¼šå»ºç«‹ 5 å€‹ service æª”æ¡ˆï¼ˆtodoã€taskã€groupã€profileã€timelineï¼‰
- æ‰€æœ‰ View ç§»é™¤ç›´æ¥ `api.` å‘¼å«ï¼Œæ”¹ç”¨ service å±¤
- ä¿®æ­£ `Sidebar.vue` fragment æ ¹ç¯€é»è­¦å‘Šï¼ˆåŠ  wrapper div + defineEmitsï¼‰
- ä¿®æ­£ `TasksView.vue` æ—¥æœŸæ ¼å¼å•é¡Œï¼ˆ`.slice(0, 10)`ï¼‰
- ä¿®æ­£ `tasks.py` assistant æ¬„ä½ array â†’ string è½‰æ›
- ä¿®æ­£ `timelines.py` task_comments SQL æ¬„ä½åç¨±éŒ¯èª¤
- `TasksView.vue` è¡¨å–®æ”¹ç‚º Modalï¼ˆTeleportï¼‰
- `TimelinesView.vue` ç¡¬ç·¨ç¢¼ URL æ”¹ç‚º `apiBaseUrl` è®Šæ•¸
- åŸä¼° 3 å¤©ï¼Œå¯¦éš› 1 å¤©ï¼ˆVibe Coding åŠ é€Ÿï¼‰
- **Step 0-2 å®Œæˆ**ï¼šå»ºç«‹ todos å’Œ tasks store
- `stores/todos.js` â€” å®Œæˆ CRUDã€computed filtersï¼ˆç„¡ loadingï¼‰
- `stores/tasks.js` â€” å®Œæˆ CRUDã€subtasks æ“ä½œï¼ˆæœ‰ loadingï¼Œä¾› TimelinesView ä½¿ç”¨ï¼‰
- TodosViewã€TasksView æ”¹ç”¨ storeï¼Œæ¸¬è©¦é€šé
- ä¿®æ­£ datetime-local æ™‚å€å•é¡Œã€storeToRefs éŸ¿æ‡‰å¼å•é¡Œ
- åŸä¼° 3ï½5 å¤©ï¼Œå¯¦éš› 1 å¤©

### 2026/02/25 Phase 0 Step 0-3 å®Œæˆ
- **Step 0-3 å®Œæˆ**ï¼šTimelinesView.vue ç¬¬ä¸€å±¤æ‹†åˆ†
- `TimelinesView.vue` 2569 è¡Œ â†’ **301 è¡Œ**ï¼ˆé™å¹… 88%ï¼Œé è¶…ç›®æ¨™ 1200 è¡Œï¼‰
- æ–°å¢ `components/timelines/TimelineHeader.vue`ï¼ˆ125 è¡Œï¼‰ï¼šHeader + Stats + ViewToggle
- æ–°å¢ `components/timelines/TimelineViewModes.vue`ï¼ˆ741 è¡Œï¼‰ï¼š4 ç¨®è¦–åœ– + çœ‹æ¿ä»»å‹™ Modal
- æ–°å¢ `components/timelines/TimelineDetailDialog.vue`ï¼ˆ405 è¡Œï¼‰ï¼šå°ˆæ¡ˆè©³æƒ… + ä»»å‹™æ‰€æœ‰ Modal
- å­å…ƒä»¶ç›´æ¥å‘¼å« serviceï¼ˆPhase 0 åŸå‰‡ï¼šä¸æ–°å¢ timelines storeï¼‰ï¼Œé€é emit é€šçŸ¥çˆ¶å±¤åˆ·æ–°
- ä¿®æ­£ TimelineDetailDialog çš„ service æ–¹æ³•å‘¼å«ï¼ˆä½¿ç”¨æ­£ç¢ºçš„ timelineService æ–¹æ³•ï¼‰
- èˆŠæª”æ¡ˆå‚™ä»½ç‚º `TimelinesView.vue.bak`ï¼ˆå…± 2569 è¡Œï¼‰
- Vite ç·¨è­¯é€šéï¼š136 æ¨¡çµ„ç„¡éŒ¯èª¤
- åŸä¼° 1ï½2 å¤©ï¼Œå¯¦éš› 1 å¤©
